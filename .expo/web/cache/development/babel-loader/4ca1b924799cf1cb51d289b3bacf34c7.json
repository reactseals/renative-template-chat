{"ast":null,"code":"\n\n\n\n\n\n\n\n\n'use strict';\n\nexports.__esModule = true;\nexports.default = void 0;\n\nvar _performanceNow = _interopRequireDefault(require(\"fbjs/lib/performanceNow\"));\n\nvar _warning = _interopRequireDefault(require(\"fbjs/lib/warning\"));\n\nfunction _interopRequireDefault(obj) {return obj && obj.__esModule ? obj : { default: obj };}\n\nfunction ownKeys(object, enumerableOnly) {var keys = Object.keys(object);if (Object.getOwnPropertySymbols) {var symbols = Object.getOwnPropertySymbols(object);if (enumerableOnly) symbols = symbols.filter(function (sym) {return Object.getOwnPropertyDescriptor(object, sym).enumerable;});keys.push.apply(keys, symbols);}return keys;}\n\nfunction _objectSpread(target) {for (var i = 1; i < arguments.length; i++) {var source = arguments[i] != null ? arguments[i] : {};if (i % 2) {ownKeys(Object(source), true).forEach(function (key) {_defineProperty(target, key, source[key]);});} else if (Object.getOwnPropertyDescriptors) {Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));} else {ownKeys(Object(source)).forEach(function (key) {Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));});}}return target;}\n\nfunction _defineProperty(obj, key, value) {if (key in obj) {Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true });} else {obj[key] = value;}return obj;}\n\nvar Info = function Info() {\n  this.any_blank_count = 0;\n  this.any_blank_ms = 0;\n  this.any_blank_speed_sum = 0;\n  this.mostly_blank_count = 0;\n  this.mostly_blank_ms = 0;\n  this.pixels_blank = 0;\n  this.pixels_sampled = 0;\n  this.pixels_scrolled = 0;\n  this.total_time_spent = 0;\n  this.sample_count = 0;\n};\n\nvar DEBUG = false;\nvar _listeners = [];\nvar _minSampleCount = 10;\n\nvar _sampleRate = DEBUG ? 1 : null;\n\n\n\n\n\n\n\n\n\n\nvar FillRateHelper =\n\nfunction () {\n  FillRateHelper.addListener = function addListener(callback) {\n    (0, _warning.default)(_sampleRate !== null, 'Call `FillRateHelper.setSampleRate` before `addListener`.');\n\n    _listeners.push(callback);\n\n    return {\n      remove: function remove() {\n        _listeners = _listeners.filter(function (listener) {\n          return callback !== listener;\n        });\n      } };\n\n  };\n\n  FillRateHelper.setSampleRate = function setSampleRate(sampleRate) {\n    _sampleRate = sampleRate;\n  };\n\n  FillRateHelper.setMinSampleCount = function setMinSampleCount(minSampleCount) {\n    _minSampleCount = minSampleCount;\n  };\n\n  function FillRateHelper(getFrameMetrics) {\n    this._anyBlankStartTime = null;\n    this._enabled = false;\n    this._info = new Info();\n    this._mostlyBlankStartTime = null;\n    this._samplesStartTime = null;\n    this._getFrameMetrics = getFrameMetrics;\n    this._enabled = (_sampleRate || 0) > Math.random();\n\n    this._resetData();\n  }\n\n  var _proto = FillRateHelper.prototype;\n\n  _proto.activate = function activate() {\n    if (this._enabled && this._samplesStartTime == null) {\n      DEBUG && console.debug('FillRateHelper: activate');\n      this._samplesStartTime = (0, _performanceNow.default)();\n    }\n  };\n\n  _proto.deactivateAndFlush = function deactivateAndFlush() {\n    if (!this._enabled) {\n      return;\n    }\n\n    var start = this._samplesStartTime;\n\n    if (start == null) {\n      DEBUG && console.debug('FillRateHelper: bail on deactivate with no start time');\n      return;\n    }\n\n    if (this._info.sample_count < _minSampleCount) {\n\n      this._resetData();\n\n      return;\n    }\n\n    var total_time_spent = (0, _performanceNow.default)() - start;\n\n    var info = _objectSpread({}, this._info, {\n      total_time_spent: total_time_spent });\n\n\n    if (DEBUG) {\n      var derived = {\n        avg_blankness: this._info.pixels_blank / this._info.pixels_sampled,\n        avg_speed: this._info.pixels_scrolled / (total_time_spent / 1000),\n        avg_speed_when_any_blank: this._info.any_blank_speed_sum / this._info.any_blank_count,\n        any_blank_per_min: this._info.any_blank_count / (total_time_spent / 1000 / 60),\n        any_blank_time_frac: this._info.any_blank_ms / total_time_spent,\n        mostly_blank_per_min: this._info.mostly_blank_count / (total_time_spent / 1000 / 60),\n        mostly_blank_time_frac: this._info.mostly_blank_ms / total_time_spent };\n\n\n      for (var key in derived) {\n        derived[key] = Math.round(1000 * derived[key]) / 1000;\n      }\n\n      console.debug('FillRateHelper deactivateAndFlush: ', {\n        derived: derived,\n        info: info });\n\n    }\n\n    _listeners.forEach(function (listener) {\n      return listener(info);\n    });\n\n    this._resetData();\n  };\n\n  _proto.computeBlankness = function computeBlankness(props, state, scrollMetrics) {\n    if (!this._enabled || props.getItemCount(props.data) === 0 || this._samplesStartTime == null) {\n      return 0;\n    }\n\n    var dOffset = scrollMetrics.dOffset,\n    offset = scrollMetrics.offset,\n    velocity = scrollMetrics.velocity,\n    visibleLength = scrollMetrics.visibleLength;\n\n\n    this._info.sample_count++;\n    this._info.pixels_sampled += Math.round(visibleLength);\n    this._info.pixels_scrolled += Math.round(Math.abs(dOffset));\n    var scrollSpeed = Math.round(Math.abs(velocity) * 1000);\n\n\n    var now = (0, _performanceNow.default)();\n\n    if (this._anyBlankStartTime != null) {\n      this._info.any_blank_ms += now - this._anyBlankStartTime;\n    }\n\n    this._anyBlankStartTime = null;\n\n    if (this._mostlyBlankStartTime != null) {\n      this._info.mostly_blank_ms += now - this._mostlyBlankStartTime;\n    }\n\n    this._mostlyBlankStartTime = null;\n    var blankTop = 0;\n    var first = state.first;\n\n    var firstFrame = this._getFrameMetrics(first);\n\n    while (first <= state.last && (!firstFrame || !firstFrame.inLayout)) {\n      firstFrame = this._getFrameMetrics(first);\n      first++;\n    }\n\n\n\n    if (firstFrame && first > 0) {\n      blankTop = Math.min(visibleLength, Math.max(0, firstFrame.offset - offset));\n    }\n\n    var blankBottom = 0;\n    var last = state.last;\n\n    var lastFrame = this._getFrameMetrics(last);\n\n    while (last >= state.first && (!lastFrame || !lastFrame.inLayout)) {\n      lastFrame = this._getFrameMetrics(last);\n      last--;\n    }\n\n\n\n    if (lastFrame && last < props.getItemCount(props.data) - 1) {\n      var bottomEdge = lastFrame.offset + lastFrame.length;\n      blankBottom = Math.min(visibleLength, Math.max(0, offset + visibleLength - bottomEdge));\n    }\n\n    var pixels_blank = Math.round(blankTop + blankBottom);\n    var blankness = pixels_blank / visibleLength;\n\n    if (blankness > 0) {\n      this._anyBlankStartTime = now;\n      this._info.any_blank_speed_sum += scrollSpeed;\n      this._info.any_blank_count++;\n      this._info.pixels_blank += pixels_blank;\n\n      if (blankness > 0.5) {\n        this._mostlyBlankStartTime = now;\n        this._info.mostly_blank_count++;\n      }\n    } else if (scrollSpeed < 0.01 || Math.abs(dOffset) < 1) {\n      this.deactivateAndFlush();\n    }\n\n    return blankness;\n  };\n\n  _proto.enabled = function enabled() {\n    return this._enabled;\n  };\n\n  _proto._resetData = function _resetData() {\n    this._anyBlankStartTime = null;\n    this._info = new Info();\n    this._mostlyBlankStartTime = null;\n    this._samplesStartTime = null;\n  };\n\n  return FillRateHelper;\n}();\n\nvar _default = FillRateHelper;\nexports.default = _default;\nmodule.exports = exports.default;","map":{"version":3,"sources":["/Users/makenzis/Desktop/renative-template-chat-refactor/renative-template-chat/node_modules/react-native-web/dist/cjs/vendor/react-native/FillRateHelper/index.js"],"names":["exports","__esModule","default","_performanceNow","_interopRequireDefault","require","_warning","obj","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","value","configurable","writable","Info","any_blank_count","any_blank_ms","any_blank_speed_sum","mostly_blank_count","mostly_blank_ms","pixels_blank","pixels_sampled","pixels_scrolled","total_time_spent","sample_count","DEBUG","_listeners","_minSampleCount","_sampleRate","FillRateHelper","addListener","callback","remove","listener","setSampleRate","sampleRate","setMinSampleCount","minSampleCount","getFrameMetrics","_anyBlankStartTime","_enabled","_info","_mostlyBlankStartTime","_samplesStartTime","_getFrameMetrics","Math","random","_resetData","_proto","prototype","activate","console","debug","deactivateAndFlush","start","info","derived","avg_blankness","avg_speed","avg_speed_when_any_blank","any_blank_per_min","any_blank_time_frac","mostly_blank_per_min","mostly_blank_time_frac","round","computeBlankness","props","state","scrollMetrics","getItemCount","data","dOffset","offset","velocity","visibleLength","abs","scrollSpeed","now","blankTop","first","firstFrame","last","inLayout","min","max","blankBottom","lastFrame","bottomEdge","blankness","enabled","_default","module"],"mappings":";;;;;;;;;AASA;;AAEAA,OAAO,CAACC,UAAR,GAAqB,IAArB;AACAD,OAAO,CAACE,OAAR,GAAkB,KAAK,CAAvB;;AAEA,IAAIC,eAAe,GAAGC,sBAAsB,CAACC,OAAO,CAAC,yBAAD,CAAR,CAA5C;;AAEA,IAAIC,QAAQ,GAAGF,sBAAsB,CAACC,OAAO,CAAC,kBAAD,CAAR,CAArC;;AAEA,SAASD,sBAAT,CAAgCG,GAAhC,EAAqC,CAAE,OAAOA,GAAG,IAAIA,GAAG,CAACN,UAAX,GAAwBM,GAAxB,GAA8B,EAAEL,OAAO,EAAEK,GAAX,EAArC,CAAwD;;AAE/F,SAASC,OAAT,CAAiBC,MAAjB,EAAyBC,cAAzB,EAAyC,CAAE,IAAIC,IAAI,GAAGC,MAAM,CAACD,IAAP,CAAYF,MAAZ,CAAX,CAAgC,IAAIG,MAAM,CAACC,qBAAX,EAAkC,CAAE,IAAIC,OAAO,GAAGF,MAAM,CAACC,qBAAP,CAA6BJ,MAA7B,CAAd,CAAoD,IAAIC,cAAJ,EAAoBI,OAAO,GAAGA,OAAO,CAACC,MAAR,CAAe,UAAUC,GAAV,EAAe,CAAE,OAAOJ,MAAM,CAACK,wBAAP,CAAgCR,MAAhC,EAAwCO,GAAxC,EAA6CE,UAApD,CAAiE,CAAjG,CAAV,CAA8GP,IAAI,CAACQ,IAAL,CAAUC,KAAV,CAAgBT,IAAhB,EAAsBG,OAAtB,EAAiC,CAAC,OAAOH,IAAP,CAAc;;AAErV,SAASU,aAAT,CAAuBC,MAAvB,EAA+B,CAAE,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGC,SAAS,CAACC,MAA9B,EAAsCF,CAAC,EAAvC,EAA2C,CAAE,IAAIG,MAAM,GAAGF,SAAS,CAACD,CAAD,CAAT,IAAgB,IAAhB,GAAuBC,SAAS,CAACD,CAAD,CAAhC,GAAsC,EAAnD,CAAuD,IAAIA,CAAC,GAAG,CAAR,EAAW,CAAEf,OAAO,CAACI,MAAM,CAACc,MAAD,CAAP,EAAiB,IAAjB,CAAP,CAA8BC,OAA9B,CAAsC,UAAUC,GAAV,EAAe,CAAEC,eAAe,CAACP,MAAD,EAASM,GAAT,EAAcF,MAAM,CAACE,GAAD,CAApB,CAAf,CAA4C,CAAnG,EAAuG,CAApH,MAA0H,IAAIhB,MAAM,CAACkB,yBAAX,EAAsC,CAAElB,MAAM,CAACmB,gBAAP,CAAwBT,MAAxB,EAAgCV,MAAM,CAACkB,yBAAP,CAAiCJ,MAAjC,CAAhC,EAA4E,CAApH,MAA0H,CAAElB,OAAO,CAACI,MAAM,CAACc,MAAD,CAAP,CAAP,CAAwBC,OAAxB,CAAgC,UAAUC,GAAV,EAAe,CAAEhB,MAAM,CAACoB,cAAP,CAAsBV,MAAtB,EAA8BM,GAA9B,EAAmChB,MAAM,CAACK,wBAAP,CAAgCS,MAAhC,EAAwCE,GAAxC,CAAnC,EAAmF,CAApI,EAAwI,CAAE,CAAC,OAAON,MAAP,CAAgB;;AAEthB,SAASO,eAAT,CAAyBtB,GAAzB,EAA8BqB,GAA9B,EAAmCK,KAAnC,EAA0C,CAAE,IAAIL,GAAG,IAAIrB,GAAX,EAAgB,CAAEK,MAAM,CAACoB,cAAP,CAAsBzB,GAAtB,EAA2BqB,GAA3B,EAAgC,EAAEK,KAAK,EAAEA,KAAT,EAAgBf,UAAU,EAAE,IAA5B,EAAkCgB,YAAY,EAAE,IAAhD,EAAsDC,QAAQ,EAAE,IAAhE,EAAhC,EAA0G,CAA5H,MAAkI,CAAE5B,GAAG,CAACqB,GAAD,CAAH,GAAWK,KAAX,CAAmB,CAAC,OAAO1B,GAAP,CAAa;;AAEjN,IAAI6B,IAAI,GAAG,SAASA,IAAT,GAAgB;AACzB,OAAKC,eAAL,GAAuB,CAAvB;AACA,OAAKC,YAAL,GAAoB,CAApB;AACA,OAAKC,mBAAL,GAA2B,CAA3B;AACA,OAAKC,kBAAL,GAA0B,CAA1B;AACA,OAAKC,eAAL,GAAuB,CAAvB;AACA,OAAKC,YAAL,GAAoB,CAApB;AACA,OAAKC,cAAL,GAAsB,CAAtB;AACA,OAAKC,eAAL,GAAuB,CAAvB;AACA,OAAKC,gBAAL,GAAwB,CAAxB;AACA,OAAKC,YAAL,GAAoB,CAApB;AACD,CAXD;;AAaA,IAAIC,KAAK,GAAG,KAAZ;AACA,IAAIC,UAAU,GAAG,EAAjB;AACA,IAAIC,eAAe,GAAG,EAAtB;;AAEA,IAAIC,WAAW,GAAGH,KAAK,GAAG,CAAH,GAAO,IAA9B;;;;;;;;;;;AAWA,IAAII,cAAc;;AAElB,YAAY;AACVA,EAAAA,cAAc,CAACC,WAAf,GAA6B,SAASA,WAAT,CAAqBC,QAArB,EAA+B;AAC1D,KAAC,GAAG/C,QAAQ,CAACJ,OAAb,EAAsBgD,WAAW,KAAK,IAAtC,EAA4C,2DAA5C;;AAEAF,IAAAA,UAAU,CAAC7B,IAAX,CAAgBkC,QAAhB;;AAEA,WAAO;AACLC,MAAAA,MAAM,EAAE,SAASA,MAAT,GAAkB;AACxBN,QAAAA,UAAU,GAAGA,UAAU,CAACjC,MAAX,CAAkB,UAAUwC,QAAV,EAAoB;AACjD,iBAAOF,QAAQ,KAAKE,QAApB;AACD,SAFY,CAAb;AAGD,OALI,EAAP;;AAOD,GAZD;;AAcAJ,EAAAA,cAAc,CAACK,aAAf,GAA+B,SAASA,aAAT,CAAuBC,UAAvB,EAAmC;AAChEP,IAAAA,WAAW,GAAGO,UAAd;AACD,GAFD;;AAIAN,EAAAA,cAAc,CAACO,iBAAf,GAAmC,SAASA,iBAAT,CAA2BC,cAA3B,EAA2C;AAC5EV,IAAAA,eAAe,GAAGU,cAAlB;AACD,GAFD;;AAIA,WAASR,cAAT,CAAwBS,eAAxB,EAAyC;AACvC,SAAKC,kBAAL,GAA0B,IAA1B;AACA,SAAKC,QAAL,GAAgB,KAAhB;AACA,SAAKC,KAAL,GAAa,IAAI3B,IAAJ,EAAb;AACA,SAAK4B,qBAAL,GAA6B,IAA7B;AACA,SAAKC,iBAAL,GAAyB,IAAzB;AACA,SAAKC,gBAAL,GAAwBN,eAAxB;AACA,SAAKE,QAAL,GAAgB,CAACZ,WAAW,IAAI,CAAhB,IAAqBiB,IAAI,CAACC,MAAL,EAArC;;AAEA,SAAKC,UAAL;AACD;;AAED,MAAIC,MAAM,GAAGnB,cAAc,CAACoB,SAA5B;;AAEAD,EAAAA,MAAM,CAACE,QAAP,GAAkB,SAASA,QAAT,GAAoB;AACpC,QAAI,KAAKV,QAAL,IAAiB,KAAKG,iBAAL,IAA0B,IAA/C,EAAqD;AACnDlB,MAAAA,KAAK,IAAI0B,OAAO,CAACC,KAAR,CAAc,0BAAd,CAAT;AACA,WAAKT,iBAAL,GAAyB,CAAC,GAAG9D,eAAe,CAACD,OAApB,GAAzB;AACD;AACF,GALD;;AAOAoE,EAAAA,MAAM,CAACK,kBAAP,GAA4B,SAASA,kBAAT,GAA8B;AACxD,QAAI,CAAC,KAAKb,QAAV,EAAoB;AAClB;AACD;;AAED,QAAIc,KAAK,GAAG,KAAKX,iBAAjB;;AAEA,QAAIW,KAAK,IAAI,IAAb,EAAmB;AACjB7B,MAAAA,KAAK,IAAI0B,OAAO,CAACC,KAAR,CAAc,uDAAd,CAAT;AACA;AACD;;AAED,QAAI,KAAKX,KAAL,CAAWjB,YAAX,GAA0BG,eAA9B,EAA+C;;AAE7C,WAAKoB,UAAL;;AAEA;AACD;;AAED,QAAIxB,gBAAgB,GAAG,CAAC,GAAG1C,eAAe,CAACD,OAApB,MAAiC0E,KAAxD;;AAEA,QAAIC,IAAI,GAAGxD,aAAa,CAAC,EAAD,EAAK,KAAK0C,KAAV,EAAiB;AACvClB,MAAAA,gBAAgB,EAAEA,gBADqB,EAAjB,CAAxB;;;AAIA,QAAIE,KAAJ,EAAW;AACT,UAAI+B,OAAO,GAAG;AACZC,QAAAA,aAAa,EAAE,KAAKhB,KAAL,CAAWrB,YAAX,GAA0B,KAAKqB,KAAL,CAAWpB,cADxC;AAEZqC,QAAAA,SAAS,EAAE,KAAKjB,KAAL,CAAWnB,eAAX,IAA8BC,gBAAgB,GAAG,IAAjD,CAFC;AAGZoC,QAAAA,wBAAwB,EAAE,KAAKlB,KAAL,CAAWxB,mBAAX,GAAiC,KAAKwB,KAAL,CAAW1B,eAH1D;AAIZ6C,QAAAA,iBAAiB,EAAE,KAAKnB,KAAL,CAAW1B,eAAX,IAA8BQ,gBAAgB,GAAG,IAAnB,GAA0B,EAAxD,CAJP;AAKZsC,QAAAA,mBAAmB,EAAE,KAAKpB,KAAL,CAAWzB,YAAX,GAA0BO,gBALnC;AAMZuC,QAAAA,oBAAoB,EAAE,KAAKrB,KAAL,CAAWvB,kBAAX,IAAiCK,gBAAgB,GAAG,IAAnB,GAA0B,EAA3D,CANV;AAOZwC,QAAAA,sBAAsB,EAAE,KAAKtB,KAAL,CAAWtB,eAAX,GAA6BI,gBAPzC,EAAd;;;AAUA,WAAK,IAAIjB,GAAT,IAAgBkD,OAAhB,EAAyB;AACvBA,QAAAA,OAAO,CAAClD,GAAD,CAAP,GAAeuC,IAAI,CAACmB,KAAL,CAAW,OAAOR,OAAO,CAAClD,GAAD,CAAzB,IAAkC,IAAjD;AACD;;AAED6C,MAAAA,OAAO,CAACC,KAAR,CAAc,qCAAd,EAAqD;AACnDI,QAAAA,OAAO,EAAEA,OAD0C;AAEnDD,QAAAA,IAAI,EAAEA,IAF6C,EAArD;;AAID;;AAED7B,IAAAA,UAAU,CAACrB,OAAX,CAAmB,UAAU4B,QAAV,EAAoB;AACrC,aAAOA,QAAQ,CAACsB,IAAD,CAAf;AACD,KAFD;;AAIA,SAAKR,UAAL;AACD,GAnDD;;AAqDAC,EAAAA,MAAM,CAACiB,gBAAP,GAA0B,SAASA,gBAAT,CAA0BC,KAA1B,EAAiCC,KAAjC,EAAwCC,aAAxC,EAAuD;AAC/E,QAAI,CAAC,KAAK5B,QAAN,IAAkB0B,KAAK,CAACG,YAAN,CAAmBH,KAAK,CAACI,IAAzB,MAAmC,CAArD,IAA0D,KAAK3B,iBAAL,IAA0B,IAAxF,EAA8F;AAC5F,aAAO,CAAP;AACD;;AAED,QAAI4B,OAAO,GAAGH,aAAa,CAACG,OAA5B;AACIC,IAAAA,MAAM,GAAGJ,aAAa,CAACI,MAD3B;AAEIC,IAAAA,QAAQ,GAAGL,aAAa,CAACK,QAF7B;AAGIC,IAAAA,aAAa,GAAGN,aAAa,CAACM,aAHlC;;;AAMA,SAAKjC,KAAL,CAAWjB,YAAX;AACA,SAAKiB,KAAL,CAAWpB,cAAX,IAA6BwB,IAAI,CAACmB,KAAL,CAAWU,aAAX,CAA7B;AACA,SAAKjC,KAAL,CAAWnB,eAAX,IAA8BuB,IAAI,CAACmB,KAAL,CAAWnB,IAAI,CAAC8B,GAAL,CAASJ,OAAT,CAAX,CAA9B;AACA,QAAIK,WAAW,GAAG/B,IAAI,CAACmB,KAAL,CAAWnB,IAAI,CAAC8B,GAAL,CAASF,QAAT,IAAqB,IAAhC,CAAlB;;;AAGA,QAAII,GAAG,GAAG,CAAC,GAAGhG,eAAe,CAACD,OAApB,GAAV;;AAEA,QAAI,KAAK2D,kBAAL,IAA2B,IAA/B,EAAqC;AACnC,WAAKE,KAAL,CAAWzB,YAAX,IAA2B6D,GAAG,GAAG,KAAKtC,kBAAtC;AACD;;AAED,SAAKA,kBAAL,GAA0B,IAA1B;;AAEA,QAAI,KAAKG,qBAAL,IAA8B,IAAlC,EAAwC;AACtC,WAAKD,KAAL,CAAWtB,eAAX,IAA8B0D,GAAG,GAAG,KAAKnC,qBAAzC;AACD;;AAED,SAAKA,qBAAL,GAA6B,IAA7B;AACA,QAAIoC,QAAQ,GAAG,CAAf;AACA,QAAIC,KAAK,GAAGZ,KAAK,CAACY,KAAlB;;AAEA,QAAIC,UAAU,GAAG,KAAKpC,gBAAL,CAAsBmC,KAAtB,CAAjB;;AAEA,WAAOA,KAAK,IAAIZ,KAAK,CAACc,IAAf,KAAwB,CAACD,UAAD,IAAe,CAACA,UAAU,CAACE,QAAnD,CAAP,EAAqE;AACnEF,MAAAA,UAAU,GAAG,KAAKpC,gBAAL,CAAsBmC,KAAtB,CAAb;AACAA,MAAAA,KAAK;AACN;;;;AAID,QAAIC,UAAU,IAAID,KAAK,GAAG,CAA1B,EAA6B;AAC3BD,MAAAA,QAAQ,GAAGjC,IAAI,CAACsC,GAAL,CAAST,aAAT,EAAwB7B,IAAI,CAACuC,GAAL,CAAS,CAAT,EAAYJ,UAAU,CAACR,MAAX,GAAoBA,MAAhC,CAAxB,CAAX;AACD;;AAED,QAAIa,WAAW,GAAG,CAAlB;AACA,QAAIJ,IAAI,GAAGd,KAAK,CAACc,IAAjB;;AAEA,QAAIK,SAAS,GAAG,KAAK1C,gBAAL,CAAsBqC,IAAtB,CAAhB;;AAEA,WAAOA,IAAI,IAAId,KAAK,CAACY,KAAd,KAAwB,CAACO,SAAD,IAAc,CAACA,SAAS,CAACJ,QAAjD,CAAP,EAAmE;AACjEI,MAAAA,SAAS,GAAG,KAAK1C,gBAAL,CAAsBqC,IAAtB,CAAZ;AACAA,MAAAA,IAAI;AACL;;;;AAID,QAAIK,SAAS,IAAIL,IAAI,GAAGf,KAAK,CAACG,YAAN,CAAmBH,KAAK,CAACI,IAAzB,IAAiC,CAAzD,EAA4D;AAC1D,UAAIiB,UAAU,GAAGD,SAAS,CAACd,MAAV,GAAmBc,SAAS,CAACnF,MAA9C;AACAkF,MAAAA,WAAW,GAAGxC,IAAI,CAACsC,GAAL,CAAST,aAAT,EAAwB7B,IAAI,CAACuC,GAAL,CAAS,CAAT,EAAYZ,MAAM,GAAGE,aAAT,GAAyBa,UAArC,CAAxB,CAAd;AACD;;AAED,QAAInE,YAAY,GAAGyB,IAAI,CAACmB,KAAL,CAAWc,QAAQ,GAAGO,WAAtB,CAAnB;AACA,QAAIG,SAAS,GAAGpE,YAAY,GAAGsD,aAA/B;;AAEA,QAAIc,SAAS,GAAG,CAAhB,EAAmB;AACjB,WAAKjD,kBAAL,GAA0BsC,GAA1B;AACA,WAAKpC,KAAL,CAAWxB,mBAAX,IAAkC2D,WAAlC;AACA,WAAKnC,KAAL,CAAW1B,eAAX;AACA,WAAK0B,KAAL,CAAWrB,YAAX,IAA2BA,YAA3B;;AAEA,UAAIoE,SAAS,GAAG,GAAhB,EAAqB;AACnB,aAAK9C,qBAAL,GAA6BmC,GAA7B;AACA,aAAKpC,KAAL,CAAWvB,kBAAX;AACD;AACF,KAVD,MAUO,IAAI0D,WAAW,GAAG,IAAd,IAAsB/B,IAAI,CAAC8B,GAAL,CAASJ,OAAT,IAAoB,CAA9C,EAAiD;AACtD,WAAKlB,kBAAL;AACD;;AAED,WAAOmC,SAAP;AACD,GAjFD;;AAmFAxC,EAAAA,MAAM,CAACyC,OAAP,GAAiB,SAASA,OAAT,GAAmB;AAClC,WAAO,KAAKjD,QAAZ;AACD,GAFD;;AAIAQ,EAAAA,MAAM,CAACD,UAAP,GAAoB,SAASA,UAAT,GAAsB;AACxC,SAAKR,kBAAL,GAA0B,IAA1B;AACA,SAAKE,KAAL,GAAa,IAAI3B,IAAJ,EAAb;AACA,SAAK4B,qBAAL,GAA6B,IAA7B;AACA,SAAKC,iBAAL,GAAyB,IAAzB;AACD,GALD;;AAOA,SAAOd,cAAP;AACD,CAhMD,EAFA;;AAoMA,IAAI6D,QAAQ,GAAG7D,cAAf;AACAnD,OAAO,CAACE,OAAR,GAAkB8G,QAAlB;AACAC,MAAM,CAACjH,OAAP,GAAiBA,OAAO,CAACE,OAAzB","sourcesContent":["/**\n * Copyright (c) 2015-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * \n * @format\n */\n'use strict';\n\nexports.__esModule = true;\nexports.default = void 0;\n\nvar _performanceNow = _interopRequireDefault(require(\"fbjs/lib/performanceNow\"));\n\nvar _warning = _interopRequireDefault(require(\"fbjs/lib/warning\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar Info = function Info() {\n  this.any_blank_count = 0;\n  this.any_blank_ms = 0;\n  this.any_blank_speed_sum = 0;\n  this.mostly_blank_count = 0;\n  this.mostly_blank_ms = 0;\n  this.pixels_blank = 0;\n  this.pixels_sampled = 0;\n  this.pixels_scrolled = 0;\n  this.total_time_spent = 0;\n  this.sample_count = 0;\n};\n\nvar DEBUG = false;\nvar _listeners = [];\nvar _minSampleCount = 10;\n\nvar _sampleRate = DEBUG ? 1 : null;\n/**\n * A helper class for detecting when the maximem fill rate of `VirtualizedList` is exceeded.\n * By default the sampling rate is set to zero and this will do nothing. If you want to collect\n * samples (e.g. to log them), make sure to call `FillRateHelper.setSampleRate(0.0-1.0)`.\n *\n * Listeners and sample rate are global for all `VirtualizedList`s - typical usage will combine with\n * `SceneTracker.getActiveScene` to determine the context of the events.\n */\n\n\nvar FillRateHelper =\n/*#__PURE__*/\nfunction () {\n  FillRateHelper.addListener = function addListener(callback) {\n    (0, _warning.default)(_sampleRate !== null, 'Call `FillRateHelper.setSampleRate` before `addListener`.');\n\n    _listeners.push(callback);\n\n    return {\n      remove: function remove() {\n        _listeners = _listeners.filter(function (listener) {\n          return callback !== listener;\n        });\n      }\n    };\n  };\n\n  FillRateHelper.setSampleRate = function setSampleRate(sampleRate) {\n    _sampleRate = sampleRate;\n  };\n\n  FillRateHelper.setMinSampleCount = function setMinSampleCount(minSampleCount) {\n    _minSampleCount = minSampleCount;\n  };\n\n  function FillRateHelper(getFrameMetrics) {\n    this._anyBlankStartTime = null;\n    this._enabled = false;\n    this._info = new Info();\n    this._mostlyBlankStartTime = null;\n    this._samplesStartTime = null;\n    this._getFrameMetrics = getFrameMetrics;\n    this._enabled = (_sampleRate || 0) > Math.random();\n\n    this._resetData();\n  }\n\n  var _proto = FillRateHelper.prototype;\n\n  _proto.activate = function activate() {\n    if (this._enabled && this._samplesStartTime == null) {\n      DEBUG && console.debug('FillRateHelper: activate');\n      this._samplesStartTime = (0, _performanceNow.default)();\n    }\n  };\n\n  _proto.deactivateAndFlush = function deactivateAndFlush() {\n    if (!this._enabled) {\n      return;\n    }\n\n    var start = this._samplesStartTime; // const for flow\n\n    if (start == null) {\n      DEBUG && console.debug('FillRateHelper: bail on deactivate with no start time');\n      return;\n    }\n\n    if (this._info.sample_count < _minSampleCount) {\n      // Don't bother with under-sampled events.\n      this._resetData();\n\n      return;\n    }\n\n    var total_time_spent = (0, _performanceNow.default)() - start;\n\n    var info = _objectSpread({}, this._info, {\n      total_time_spent: total_time_spent\n    });\n\n    if (DEBUG) {\n      var derived = {\n        avg_blankness: this._info.pixels_blank / this._info.pixels_sampled,\n        avg_speed: this._info.pixels_scrolled / (total_time_spent / 1000),\n        avg_speed_when_any_blank: this._info.any_blank_speed_sum / this._info.any_blank_count,\n        any_blank_per_min: this._info.any_blank_count / (total_time_spent / 1000 / 60),\n        any_blank_time_frac: this._info.any_blank_ms / total_time_spent,\n        mostly_blank_per_min: this._info.mostly_blank_count / (total_time_spent / 1000 / 60),\n        mostly_blank_time_frac: this._info.mostly_blank_ms / total_time_spent\n      };\n\n      for (var key in derived) {\n        derived[key] = Math.round(1000 * derived[key]) / 1000;\n      }\n\n      console.debug('FillRateHelper deactivateAndFlush: ', {\n        derived: derived,\n        info: info\n      });\n    }\n\n    _listeners.forEach(function (listener) {\n      return listener(info);\n    });\n\n    this._resetData();\n  };\n\n  _proto.computeBlankness = function computeBlankness(props, state, scrollMetrics) {\n    if (!this._enabled || props.getItemCount(props.data) === 0 || this._samplesStartTime == null) {\n      return 0;\n    }\n\n    var dOffset = scrollMetrics.dOffset,\n        offset = scrollMetrics.offset,\n        velocity = scrollMetrics.velocity,\n        visibleLength = scrollMetrics.visibleLength; // Denominator metrics that we track for all events - most of the time there is no blankness and\n    // we want to capture that.\n\n    this._info.sample_count++;\n    this._info.pixels_sampled += Math.round(visibleLength);\n    this._info.pixels_scrolled += Math.round(Math.abs(dOffset));\n    var scrollSpeed = Math.round(Math.abs(velocity) * 1000); // px / sec\n    // Whether blank now or not, record the elapsed time blank if we were blank last time.\n\n    var now = (0, _performanceNow.default)();\n\n    if (this._anyBlankStartTime != null) {\n      this._info.any_blank_ms += now - this._anyBlankStartTime;\n    }\n\n    this._anyBlankStartTime = null;\n\n    if (this._mostlyBlankStartTime != null) {\n      this._info.mostly_blank_ms += now - this._mostlyBlankStartTime;\n    }\n\n    this._mostlyBlankStartTime = null;\n    var blankTop = 0;\n    var first = state.first;\n\n    var firstFrame = this._getFrameMetrics(first);\n\n    while (first <= state.last && (!firstFrame || !firstFrame.inLayout)) {\n      firstFrame = this._getFrameMetrics(first);\n      first++;\n    } // Only count blankTop if we aren't rendering the first item, otherwise we will count the header\n    // as blank.\n\n\n    if (firstFrame && first > 0) {\n      blankTop = Math.min(visibleLength, Math.max(0, firstFrame.offset - offset));\n    }\n\n    var blankBottom = 0;\n    var last = state.last;\n\n    var lastFrame = this._getFrameMetrics(last);\n\n    while (last >= state.first && (!lastFrame || !lastFrame.inLayout)) {\n      lastFrame = this._getFrameMetrics(last);\n      last--;\n    } // Only count blankBottom if we aren't rendering the last item, otherwise we will count the\n    // footer as blank.\n\n\n    if (lastFrame && last < props.getItemCount(props.data) - 1) {\n      var bottomEdge = lastFrame.offset + lastFrame.length;\n      blankBottom = Math.min(visibleLength, Math.max(0, offset + visibleLength - bottomEdge));\n    }\n\n    var pixels_blank = Math.round(blankTop + blankBottom);\n    var blankness = pixels_blank / visibleLength;\n\n    if (blankness > 0) {\n      this._anyBlankStartTime = now;\n      this._info.any_blank_speed_sum += scrollSpeed;\n      this._info.any_blank_count++;\n      this._info.pixels_blank += pixels_blank;\n\n      if (blankness > 0.5) {\n        this._mostlyBlankStartTime = now;\n        this._info.mostly_blank_count++;\n      }\n    } else if (scrollSpeed < 0.01 || Math.abs(dOffset) < 1) {\n      this.deactivateAndFlush();\n    }\n\n    return blankness;\n  };\n\n  _proto.enabled = function enabled() {\n    return this._enabled;\n  };\n\n  _proto._resetData = function _resetData() {\n    this._anyBlankStartTime = null;\n    this._info = new Info();\n    this._mostlyBlankStartTime = null;\n    this._samplesStartTime = null;\n  };\n\n  return FillRateHelper;\n}();\n\nvar _default = FillRateHelper;\nexports.default = _default;\nmodule.exports = exports.default;"]},"metadata":{},"sourceType":"script"}